# Migration `20201011113743-0-0-13`

This migration has been generated by Taykavol at 10/11/2020, 2:37:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."InvoiceStatus" AS ENUM ('PAYOUT', 'PENDING')

CREATE TABLE "public"."Invoice" (
"id" SERIAL,
"month" integer   NOT NULL ,
"year" integer   NOT NULL ,
"profileId" integer   NOT NULL ,
"status" "InvoiceStatus"  NOT NULL ,
"deadLine" timestamp(3)   NOT NULL ,
"total" Decimal(65,30)   NOT NULL DEFAULT 0,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Invoice.month_year_profileId_unique" ON "public"."Invoice"("month", "year", "profileId")

ALTER TABLE "public"."Invoice" ADD FOREIGN KEY ("profileId")REFERENCES "public"."instructorProfile"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201010154851-0-0-12..20201011113743-0-0-13
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -30,8 +30,9 @@
   title Title?
   myCourses Course[]
   orders Order[]
   profit Float? @default(0.5)
+  invoices Invoice[]
   // videos String[]
   // paypalId String?
 }
 model BoughtCourse {
@@ -57,9 +58,20 @@
   buyerId Int
   seller instructorProfile @relation(fields: [sellerId],references:[id])
   sellerId Int
   createdAt DateTime @default(now())
+}
+model Invoice {
+  id Int @default(autoincrement()) @id
+  month Int
+  year Int 
+  profile instructorProfile @relation( fields:[profileId], references:[id])
+  profileId Int
+  status InvoiceStatus
+  deadLine DateTime
+  total Float @default(0)
+  @@unique([month,year,profileId])
 }
 model Course {
 id Int @default(autoincrement()) @id
@@ -153,8 +165,12 @@
 //   fen String
 //   moves String[]
 //   helps String[]
 // }
+enum InvoiceStatus {
+  PAYOUT
+  PENDING
+}
 enum Category {
   OPENINGS
   MIDDLEGAME
   ENDGAME
```


